<!DOCTYPE html>
<html>
<head>
  <title>Test Custom Layout</title>
  <script src="https://unpkg.com/cytoscape@3.24.0/dist/cytoscape.min.js"></script>
  <script type="module" src="./src/layout.js"></script>
  <style>
    #cy {
      width: 100%;
      height: 600px;
      border: 1px solid #aaa;
      background-color: #d1d2e0;
    }
  </style>
</head>
<body>
  <h2>Custom Layout Test</h2>
  <div id="cy"></div>
  <script type="module">
    import SemanticGridLayout from './src/layout.js';
    cytoscape.use(SemanticGridLayout);
    
    fetch('./test/data/multi-label-test.json')
      .then(res => res.json())
      .then(data => {
  console.log('Running semanticGrid layout with', data.elements);
  const cy = cytoscape({
    container: document.getElementById('cy'),
    elements: data.elements,
    style: [
      {
        selector: 'node',
        style: {
        "shape": "round-rectangle",
        "height": "8px",
        "width": "label",
        "padding": "16px",
        "font-size": "14px",
        "content": "data(id)",
        "text-valign": "center",
        "text-halign": "center",
        "background-color": "#f2f2f2",
        "border-width": "3",
        "border-color": "#5E5E5E",
        "box-radius": "5px"
        }
      },
      {
        selector: 'edge',
        style: {
          "label": "data(label)",
        "curve-style": "bezier",
        "text-opacity": 1,
        "font-size": "10px",
        "color": "#000",
        "edge-text-rotation": "autorotate",
        "arrow-scale": 1,
        "min-zoomed-font-size": "6px"
        }
      }
    ]
  });

  cy.ready(() => {
    console.log('Cytoscape ready. Nodes count:', cy.nodes().length);
    const changedNode = cy.getElementById('nodeG')
    changedNode.style({display: 'none'})

    // Jalankan layout setelah Cytoscape siap
    cy.layout({
      name: 'semanticGrid',
      // xDimension: "properties.methodCount",
      xDimension: "properties.roleStereotype",
      yDimension: "properties.dependencyProfile",
      // yDimension: "properties.dependencyProfile",
      yCategories: ["Hidden", "Inbound", "Transit", "Outbound"],
      rangeStep: {x: 1.5, y:null},
      spacing: 120,
      ready: () => {
        console.log('Custom layout ready.');
      },
      stop: () => {
        console.log('Custom layout stopped.');
        cy.nodes().forEach(n => {
          console.log(n.id(), n.position());
        });
      }
    }).run();
  });
});

  </script>
</body>
</html>